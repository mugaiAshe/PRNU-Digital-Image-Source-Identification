# PRNU-Digital-Image-Source-Identification
PRNU Digital Image Source Identification，实现PRNU指纹提取以及PRNU库的建立，使用PRNU模式匹配，分辨图像由哪些相机拍摄。

通过最优匹配PRNU计算了最优形状，然后用最优形状重新分配训练集和测试集，计算PRNU指纹，达到了辨别图像拍摄自库中某个相机或库外相机的效果。

首先对图像进行预处理，将原始图片转换为灰度图像，然后对图片进行了裁剪，剪去了外围10像素的内容，再将图片规整到统一的形状。使用小波去噪的方法提取PRNU，计算噪声残差并取平均作为PRNU指纹，再标准化。

形状的选取对指纹提取的效果影响较大，因此先实验选取多个形状，寻找最优的形状。遍历六个相机文件夹，设定选取每个文件夹中5%的图片作为测试集，其他作为训练集提取PRNU指纹。尝试使用（2048,2048）的形状，结果是在六个相机上的测试准确度为93.33%。通过最优匹配的方式简单计算不同形状下的测试准确度并可视化。测试准确度随着形状的增大而升高。

使用最优形状（2048,2048）重新建立PRNU库。因为需要分辨图片是由库内的某个相机拍摄的还是库外的，所以在训练集中删去了PENTAX K20D相机，将它作为库外相机拍摄的样本。根据观察发现各个相机图片和PRNU指纹的相关系数变化较大，因此需要给每个相机指定不同的阈值。计算每个相机PRNU指纹的阈值，在该相机的训练集上选取十张样本，计算训练样本与PRNU指纹的匹配度，选取最低值再*0.1，作为该相机的匹配度阈值。这是因为实践证明，图片在源相机上的指纹匹配度与其他相机的差距较大，因此将阈值往小取能有效提高测试准确度。用阈值匹配PRNU，若图片与PRNU指纹库中所有相机的匹配度都没达到阈值，则认为不是库内的相机拍摄的；若图片与PRNU指纹库中多个相机的匹配度都达到了阈值，则选取相关系数与阈值的比值最大的那一类。重新测试，在六个相机上的测试准确度是90.0%，提取了有效的PRNU指纹，设置了合适的阈值，能通过阈值实现对图片是否由库中相机拍摄的判断。
